<div class="login-container">
  <!-- Partie gauche - Formulaire de réinitialisation -->
  <div class="login-form-container">
    <div class="login-form-content">
      <div class="brand">
        <a href="/home"><img src="assets/images/image.png" alt="Logo" class="logo"></a>
      </div>
      <div class="text-center">
        <h2 class="welcome-title">Réinitialisation du mot de passe</h2>
        <p class="subtitle">
          {{ resetStep === 'request' ? 'Veuillez saisir votre adresse email pour recevoir un lien de réinitialisation' : 'Veuillez saisir votre nouveau mot de passe ci-dessous' }}
        </p>
      </div>

      <!-- Premier état: saisie du code et nouveau mot de passe -->
      <form *ngIf="resetStep === 'reset' && !isResetSuccess" name="form" (ngSubmit)="f.form.valid && onSubmit()" #f="ngForm" novalidate>
        <div class="form-group">
          <div class="input-wrapper">
            <i class="fa fa-key input-icon"></i>
            <input type="hidden" class="form-control custom-input" name="code" [(ngModel)]="form.code"
              required #code="ngModel" placeholder="Entrez le code reçu par email" />
          </div>
          <div class="error-message" *ngIf="code.errors && f.submitted">
            <div *ngIf="code.errors['required']">Le code de réinitialisation est requis</div>
          </div>
        </div>
        
        <div class="form-group">
          <label for="newPassword">Nouveau mot de passe <span class="text-danger">*</span></label>
          <div class="input-wrapper">
            <i class="fa fa-lock input-icon"></i>
            <input [type]="showPassword ? 'text' : 'password'" class="form-control custom-input" name="newPassword" [(ngModel)]="form.newPassword"
              required minlength="6" #newPassword="ngModel" placeholder="Entrez votre nouveau mot de passe" />
            <i class="fa fa-eye toggle-password" [class.fa-eye-slash]="showPassword" (click)="togglePasswordVisibility()"></i>
          </div>
          <div class="error-message" *ngIf="newPassword.errors && f.submitted">
            <div *ngIf="newPassword.errors['required']">Le nouveau mot de passe est requis</div>
            <div *ngIf="newPassword.errors['minlength']">Le mot de passe doit comporter au moins 6 caractères</div>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirmation du mot de passe <span class="text-danger">*</span></label>
          <div class="input-wrapper">
            <i class="fa fa-lock input-icon"></i>
            <input [type]="showConfirmPassword ? 'text' : 'password'" class="form-control custom-input" name="confirmPassword" [(ngModel)]="form.confirmPassword"
              required #confirmPassword="ngModel" placeholder="Confirmez votre nouveau mot de passe" />
            <i class="fa fa-eye toggle-password" [class.fa-eye-slash]="showConfirmPassword" (click)="toggleConfirmPasswordVisibility()"></i>
          </div>
          <div class="error-message" *ngIf="confirmPassword.errors && f.submitted">
            <div *ngIf="confirmPassword.errors['required']">La confirmation du mot de passe est requise</div>
          </div>
          <div class="error-message" *ngIf="f.submitted && passwordsNotMatching">
            Les mots de passe ne correspondent pas
          </div>
        </div>
       
        <div class="form-group">
          <button class="btn-login">Réinitialiser le mot de passe</button>
        </div>
       
        <div class="form-group">
          <div class="error-message login-failed" *ngIf="f.submitted && isResetFailed">
            La réinitialisation a échoué : {{ errorMessage }}
          </div>
        </div>
      </form>

      <!-- Formulaire pour demander le code d'abord -->
      <form *ngIf="resetStep === 'request' && !isCodeSent" name="requestForm" (ngSubmit)="r.form.valid && onRequestCode()" #r="ngForm" novalidate>
        <div class="form-group">
          <label for="email">Adresse Email <span class="text-danger">*</span></label>
          <div class="input-wrapper">
            <i class="fa fa-envelope input-icon"></i>
            <input type="email" class="form-control custom-input" name="email" [(ngModel)]="requestForm.email"
              required email #email="ngModel" placeholder="Entrez votre adresse email" />
          </div>
          <div class="error-message" *ngIf="email.errors && r.submitted">
            <div *ngIf="email.errors['required']">L'adresse email est requise</div>
            <div *ngIf="email.errors['email']">L'adresse email n'est pas valide</div>
          </div>
        </div>
        
        <div class="form-group">
          <button class="btn-login pulse-animation">Demander un code de réinitialisation</button>
        </div>
       
        <div class="form-group">
          <div class="error-message login-failed" *ngIf="r.submitted && isRequestFailed">
            La demande a échoué : {{ requestErrorMessage }}
          </div>
        </div>
      </form>

      <!-- Message de confirmation d'envoi du code -->
      <div class="info-message" *ngIf="isCodeSent && resetStep === 'request'">
        <i class="fa fa-envelope-open-text info-icon"></i>
        <h3>Email envoyé !</h3>
        <p>Un lien de réinitialisation a été envoyé à votre adresse email.</p>
        <p class="small-text">Vérifiez votre boîte de réception et vos spams</p>
        <button class="btn-login mt-3" (click)="resetStep = 'reset'">Saisir mon nouveau mot de passe</button>
      </div>

      <!-- Message de succès -->
      <div class="success-message" *ngIf="isResetSuccess">
        <i class="fa fa-check-circle success-icon"></i>
        <h3>Réinitialisation réussie !</h3>
        <p>Votre mot de passe a été réinitialisé avec succès.</p>
        <button class="btn-login mt-3" (click)="navigateToLogin()">Retour à la connexion</button>
      </div>

      <div class="back-to-login">
        <a href="/login">Retour à la page de connexion</a>
      </div>
    </div>
  </div>
 
  <!-- Partie droite - Image -->
  <div class="login-image-container">
   
  </div>
</div>