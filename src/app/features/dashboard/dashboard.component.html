<!-- dashboard.component.html -->
<div class="dashboard-container">

  <div class="sidebar" [class.collapsed]="isCollapsed" [class.mobile-open]="isMobileOpen">
    <div class="sidebar-header">
      <div class="logo">
        <a href="/home">
          <img [src]="logoUrl" alt="Logo" class="logo-img" *ngIf="!isCollapsed">
          <img [src]="logoIconUrl" alt="Logo" class="logo-icon" *ngIf="isCollapsed">
        </a>
      </div>
      <!-- <button class="collapse-btn" (click)="toggleCollapse()">
        <i class="bi" [ngClass]="isCollapsed ? 'bi-chevron-right' : 'bi-chevron-left'"></i>
      </button> -->
    </div>

    <!-- User Profile - Visible at the top on mobile -->
    <div class="user-profile-mobile" *ngIf="isMobile()">
      <div class="user-avatar">
        <span>{{getUserInitials()}}</span>
      </div>
      <div class="user-info" *ngIf="!isCollapsed">
        <div class="user-name">{{username}}</div>
        <div class="user-role">{{userRole}}</div>
      </div>
    </div>

    <!-- Navigation Menu -->
    <div class="nav-wrapper">
      <nav class="nav-menu">
        <!-- Dashboard -->
        <div class="menu-item" [class.active]="selectedMenu === 'Accueil'" (click)="selectMenuItem('Accueil')">
          <div class="menu-icon">
            <i class="bi bi-house-fill"></i>
          </div>
          <span class="menu-text" *ngIf="!isCollapsed">Accueil</span>
          <div class="tooltip" *ngIf="isCollapsed">
            <span class="tooltiptext">Accueil</span>
          </div>
        </div>

        <!-- Librairie section -->
        <div class="menu-section">
          <div class="menu-header" [class.active]="selectedMenu === 'Librairie'" (click)="selectMenuItem('Librairie')">
            <div class="menu-icon">
              <i class="bi bi-book-fill"></i>
            </div>
            <span class="menu-text" *ngIf="!isCollapsed">Librairie</span>
            <div class="menu-arrow" *ngIf="!isCollapsed">
              <i class="bi" [ngClass]="selectedMenu === 'Librairie' ? 'bi-chevron-down' : 'bi-chevron-right'"></i>
            </div>
            <div class="tooltip" *ngIf="isCollapsed">
              <span class="tooltiptext">Librairie</span>
            </div>
          </div>

          <div class="submenu" [class.show]="selectedMenu === 'Librairie'" [class.collapsed]="isCollapsed">
            <div class="submenu-item" [class.active]="selectedLibraryItem === 'Web'" (click)="selectLibraryItem('Web')">
              <div class="submenu-icon">
                <i class="bi bi-laptop"></i>
              </div>
              <span class="submenu-text" *ngIf="!isCollapsed">Web</span>
              <div class="submenu-arrow" *ngIf="!isCollapsed">
                <i class="bi"
                  [ngClass]="selectedLibraryItem === 'Web' && selectedWebItem ? 'bi-chevron-down' : 'bi-chevron-right'"></i>
              </div>
              <div class="tooltip" *ngIf="isCollapsed">
                <span class="tooltiptext">Web</span>
              </div>
            </div>

            <!-- Web submenu - montré seulement si selectedWebItem a une valeur -->
            <div class="web-submenu" [class.show]="selectedLibraryItem === 'Web' && selectedWebItem"
              [class.collapsed]="isCollapsed">
              <div class="web-buttons" [class.compact]="isCollapsed">
                <button class="web-btn" [class.active]="selectedWebItem === 'Images'" (click)="selectWebItem('Images')">
                  <i class="bi bi-image"></i>
                  <span *ngIf="!isCollapsed">Images</span>
                </button>
                <button class="web-btn" [class.active]="selectedWebItem === 'Vidéos'" (click)="selectWebItem('Vidéos')">
                  <i class="bi bi-film"></i>
                  <span *ngIf="!isCollapsed">Vidéos</span>
                </button>
                <button class="web-btn" [class.active]="selectedWebItem === 'Pictos'" (click)="selectWebItem('Pictos')">
                  <i class="bi bi-person"></i>
                  <span *ngIf="!isCollapsed">Pictos</span>
                </button>
                <button class="web-btn" [class.active]="selectedWebItem === 'Documents'"
                  (click)="selectWebItem('Documents')">
                  <i class="bi bi-file-earmark-text"></i>
                  <span *ngIf="!isCollapsed">Documents</span>
                </button>
              </div>
            </div>

            <div class="submenu-item" [class.active]="selectedLibraryItem === 'Mobile'"
              (click)="selectLibraryItem('Mobile')">
              <div class="submenu-icon">
                <i class="bi bi-phone"></i>
              </div>
              <span class="submenu-text" *ngIf="!isCollapsed">Mobile</span>
              <div class="tooltip" *ngIf="isCollapsed">
                <span class="tooltiptext">Mobile</span>
              </div>
            </div>

            <div class="submenu-item" [class.active]="selectedLibraryItem === 'SM'" (click)="selectLibraryItem('SM')">
              <div class="submenu-icon">
                <i class="bi bi-microsoft"></i>
              </div>
              <span class="submenu-text" *ngIf="!isCollapsed">Social Media</span>
              <div class="tooltip" *ngIf="isCollapsed">
                <span class="tooltiptext">Social Media</span>
              </div>
            </div>

            <div class="submenu-item" [class.active]="selectedLibraryItem === 'PLV'" (click)="selectLibraryItem('PLV')">
              <div class="submenu-icon">
                <i class="bi bi-display"></i>
              </div>
              <span class="submenu-text" *ngIf="!isCollapsed">P.L.V</span>
              <div class="tooltip" *ngIf="isCollapsed">
                <span class="tooltiptext">P.L.V</span>
              </div>
            </div>

            <div class="submenu-item" [class.active]="selectedLibraryItem === 'Campagnes'"
              (click)="selectLibraryItem('Campagnes')">
              <div class="submenu-icon">
                <i class="bi bi-megaphone-fill"></i>
              </div>
              <span class="submenu-text" *ngIf="!isCollapsed">Campagnes</span>
              <div class="tooltip" *ngIf="isCollapsed">
                <span class="tooltiptext">Campagnes</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Gestion section - Admin ou Super Admin -->
        <div class="menu-section" *ngIf="isAdmin || isSuperAdmin">
          <div class="menu-header" [class.active]="selectedMenu === 'Gestion'" (click)="selectMenuItem('Gestion')">
            <div class="menu-icon">
              <i class="bi bi-gear-fill"></i>
            </div>
            <span class="menu-text" *ngIf="!isCollapsed">Gestion</span>
            <div class="menu-arrow" *ngIf="!isCollapsed">
              <i class="bi" [ngClass]="selectedMenu === 'Gestion' ? 'bi-chevron-down' : 'bi-chevron-right'"></i>
            </div>
            <div class="tooltip" *ngIf="isCollapsed">
              <span class="tooltiptext">Gestion</span>
            </div>
          </div>

          <div class="submenu" [class.show]="selectedMenu === 'Gestion'" [class.collapsed]="isCollapsed">
            <!-- Administrateurs - disponible uniquement pour les super admins -->
            <div class="submenu-item" *ngIf="isSuperAdmin" [class.active]="selectedLibraryItem === 'Administrateur'"
              (click)="selectLibraryItem('Administrateur')">
              <div class="submenu-icon">
                <i class="bi bi-shield-lock-fill"></i>
              </div>
              <span class="submenu-text" *ngIf="!isCollapsed">Administrateurs</span>
              <div class="tooltip" *ngIf="isCollapsed">
                <span class="tooltiptext">Administrateurs</span>
              </div>
            </div>

            <!-- Utilisateurs - disponible pour les admins et super admins -->
            <div class="submenu-item" [class.active]="selectedLibraryItem === 'Utilisateurs'"
              (click)="selectLibraryItem('Utilisateurs')">
              <div class="submenu-icon">
                <i class="bi bi-people-fill"></i>
              </div>
              <span class="submenu-text" *ngIf="!isCollapsed">Utilisateurs</span>
              <div class="tooltip" *ngIf="isCollapsed">
                <span class="tooltiptext">Utilisateurs</span>
              </div>
            </div>

            <div class="submenu-item" [class.active]="selectedLibraryItem === 'Roles'"
              (click)="selectLibraryItem('Roles')">
              <div class="submenu-icon">
                <i class="bi bi-person-badge"></i>
              </div>
              <span class="submenu-text" *ngIf="!isCollapsed">Rôles</span>
              <div class="tooltip" *ngIf="isCollapsed">
                <span class="tooltiptext">Rôles</span>
              </div>
            </div>
          </div>
        </div>
      </nav>
    </div>

    <!-- User Profile - Desktop version at bottom -->
    <div class="user-profile" (click)="openUserDashboard()" *ngIf="!isMobile()">
      <div class="user-avatar">
        <span>{{getUserInitials()}}</span>
      </div>
      <div class="user-info" *ngIf="!isCollapsed">
        <div class="user-name">{{username}}</div>
        <div class="user-role">{{userRole}}</div>
      </div>
      <div class="profile-icon" *ngIf="!isCollapsed">
        <i class="bi bi-chevron-right"></i>
      </div>
    </div>

    <!-- Logout Button -->
    <div class="logout-button" (click)="logout()">
      <div class="logout-icon">
        <i class="bi bi-box-arrow-right"></i>
      </div>
      <span class="logout-text" *ngIf="!isCollapsed">Déconnexion</span>
    </div>
  </div>

  <!-- Mobile toggle button - outside sidebar -->
  <button class="mobile-toggle" *ngIf="isMobile()" (click)="toggleMobileMenu()">
    <i class="bi" [ngClass]="isMobileOpen ? 'bi-x-lg' : 'bi-list'"></i>
  </button>

  <!-- Overlay for mobile -->
  <div class="sidebar-overlay" [class.active]="isMobileOpen" (click)="closeMobileMenu()"></div>

  <!-- Partie pour le contenu dynamique du dashboard -->
  <div class="dynamic-content">
    <!-- Contenu d'accueil qui sera toujours affiché par défaut -->
    <app-home-content *ngIf="showAccueil"></app-home-content>

    <!-- Contenus spécifiques qui remplacent l'accueil quand sélectionnés -->
    <app-images *ngIf="showImages"></app-images>

    <!-- Remplacer par les composants réels quand ils seront disponibles -->
    <app-videos *ngIf="showVideos"></app-videos>

    <app-pictos *ngIf="showPictos"></app-pictos>

    <app-documents *ngIf="showDocuments"></app-documents>

    <app-campagnes *ngIf="showCampagnes"></app-campagnes>

    <app-plv *ngIf="showPlv"></app-plv>

    <app-mobile *ngIf="showMobile"></app-mobile>

    <app-social-media *ngIf="showSocialMedia"></app-social-media>
    
    <!-- User Management Component -->
    <app-user-management *ngIf="showUserManagement"></app-user-management>

    <app-roles *ngIf="showRoles"></app-roles>

    <app-profiles *ngIf="showProfiles"></app-profiles>
  </div>
</div>